<!DOCTYPE html>
<html>
<head>
    <title>üèÅ –ì–æ–Ω–∫–∏ –º–∞—à–∏–Ω</title>
    <style>
        body { font-family: Arial; text-align: center; padding: 20px; }
        .car { font-family: monospace; font-size: 16px; margin: 10px; }
        .red { color: red; }
        .blue { color: blue; }
        .green { color: green; }
        button { font-size: 16px; padding: 10px 20px; margin: 10px; }
        .start { background: green; color: white; }
        .reset { background: red; color: white; }
    </style>
</head>
<body>
    <h1>üèÅ –ì–û–ù–ö–ò –ú–ê–®–ò–ù üèÅ</h1>
    
    <button class="start" onclick="startRace()">–°–¢–ê–†–¢</button>
    <button class="reset" onclick="resetRace()">–°–ë–†–û–°</button>
    
    <div id="status">–ì–æ—Ç–æ–≤ –∫ –≥–æ–Ω–∫–∞–º</div>
    <br>
    
    <div id="cars">
        <div class="car red" id="car0">–ö—Ä–∞—Å–Ω–∞—è: –ñ–¥–µ—Ç —Å—Ç–∞—Ä—Ç–∞</div>
        <div class="car blue" id="car1">–°–∏–Ω—è—è: –ñ–¥–µ—Ç —Å—Ç–∞—Ä—Ç–∞</div>
        <div class="car green" id="car2">–ó–µ–ª–µ–Ω–∞—è: –ñ–¥–µ—Ç —Å—Ç–∞—Ä—Ç–∞</div>
    </div>
    
    <script>
        async function startRace() {
            const response = await fetch('/start');
            const result = await response.json();
            document.getElementById('status').innerText = result.message;
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π
            updateRace();
        }
        
        async function resetRace() {
            const response = await fetch('/reset');
            const result = await response.json();
            document.getElementById('status').innerText = result.message;
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            for (let i = 0; i < 3; i++) {
                const carNames = ['–ö—Ä–∞—Å–Ω–∞—è', '–°–∏–Ω—è—è', '–ó–µ–ª–µ–Ω–∞—è'];
                document.getElementById(`car${i}`).innerText = `${carNames[i]}: –ñ–¥–µ—Ç —Å—Ç–∞—Ä—Ç–∞`;
            }
        }
        
        async function updateRace() {
            const response = await fetch('/status');
            const data = await response.json();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–∞—à–∏–Ω
            const carNames = ['–ö—Ä–∞—Å–Ω–∞—è', '–°–∏–Ω—è—è', '–ó–µ–ª–µ–Ω–∞—è'];
            for (let i = 0; i < 3; i++) {
                const position = data.positions[i];
                const distance = data.distance;
                
                let progress = 'üöó' + '‚ñà'.repeat(position) + '‚ñë'.repeat(distance - position);
                
                if (position >= distance) {
                    progress = 'üèÜ –§–ò–ù–ò–®!';
                }
                
                document.getElementById(`car${i}`).innerText = `${carNames[i]}: ${progress}`;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
            if (data.winner) {
                document.getElementById('status').innerText = `üèÜ –ü–æ–±–µ–¥–∏—Ç–µ–ª—å: ${data.winner}!`;
            } else if (data.racing) {
                document.getElementById('status').innerText = 'üèÅ –ì–æ–Ω–∫–∏ –∏–¥—É—Ç!';
                // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
                setTimeout(updateRace, 500);
            }
        }
    </script>
</body>
</html>